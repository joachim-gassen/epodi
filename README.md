## Earnings Properties of a Dynamic Investment Model

### Idea

This repository contains a sketchy reanalysis of the findings of the working paper
"(Mis-)Matching and Earnings Properties: Implications of Dynamic Investments" by Matthias Breuer and David Windisch. By building on the [QuantEcon Python Package](https://quantecon.org), it uses a different code base than [Breuer and Windisch (JAR, 2017)](https://doi.org/10.1111/1475-679X.12253) so deviations from the original findings are to be expected. The goal is to provide a more accessible and flexible implementation of the model, which can be used for further research and analysis.


### Setup

You need Python 3.8 or higher to estimate the dynamic investment model and R to download the required WRDS data and to run the analysis.

To setup the virtual Python environment and install the required packages, run the following command in your terminal:

```bash
# Create a virtual environment
python -m venv .venv
# Activate the virtual environment
# On Windows
.venv\Scripts\activate
# On MacOS/Linux
source .venv/bin/activate
# Install the required packages
pip install -r requirements.txt
```

To estimate the dynamic investment model underlying the analysis, you need an environment with a lot of RAM/swap space (about 350 GB). If you are short on RAM. you might be able to adjust the size of the estimation grid by setting `k_size`and `z_size` in `code/di_model.py` to smaller values (e.g. 100/100).

Source the `code/di_model.py` file to run the model. The resulting grid will be stored in in the `data/grids` folder. 

For convenience, three grids are already included in the repository. So. you can skip this step if you want to use the precomputed grid.

Based on the (precomputed) grids, you can source the R file `code/create_sim_panels.R` to create the simulation panels for various (conservatism) values. The simulation panels are stored in the `data/generated` folder. Generating the samples will take 1-2 hours (I sense some serious speed-up pontential here...). 

For downloading the required WRDS data, you need to have a WRDS account and access to CRSP, Compustat North America, and the CRSP Compustat merged suite. 

Copy the file '_config.env' to 'config.env' and fill in your WRDS credentials. Do **not** commit the `config.env` file to the repository (it is included in `.gitignore` to avoid you doing this accidentally).

Then, source the R file `code/pull_wrds_data.R` to download the required data. The data will be stored as parquet files in the `data/wrds` folder. The download should take about 30 minutes. (I am lazy and thus have the tendency to download complete datasets instead of filtering them in the SQL query. Sorry.)

After pulling the WRDS data, source `code/generate_wrds_panel.R` to create the panel data for the analysis. The panel data will be stored in the `data/generated` folder. 


### Analysis

Finally, you can run the R scripts `code/analysis_sim_data.R` and `code/analysis_wrds_data.R` to run some basic analyses that allow you to explore some insights generated by David and Matthias in their working paper.


### License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.


### Acknowledgements

This project has been developed jointly with the [Open Science Data Center](https://www.accounting-for-transparency.de/projects/open-science-data-center/) of the [TRR 266 "Accounting for Transparency"](https://www.accounting-for-transparency.de) and its repository is inspired by their [treat repository](https://github.com/trr266/treat). 